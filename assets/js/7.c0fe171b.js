(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{208:function(a,t,s){"use strict";s.r(t);var e=s(0),n=Object(e.a)({},function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"caddy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#caddy","aria-hidden":"true"}},[a._v("#")]),a._v(" Caddy")]),a._v(" "),s("h2",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装","aria-hidden":"true"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),s("h3",{attrs:{id:"ubuntu-平台"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu-平台","aria-hidden":"true"}},[a._v("#")]),a._v(" "),s("code",[a._v("Ubuntu")]),a._v(" 平台")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" https://getcaddy.com "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v(" -s personal\n")])])]),s("p",[a._v("安装完成后，我们需要将 "),s("code",[a._v("cap_net_bind_servicecapability")]),a._v(" 添加到 "),s("code",[a._v("Caddy")]),a._v(" 二进制文件中。\n此功能将允许 "),s("code",[a._v("Caddy")]),a._v(" 可执行文件绑定到小于 "),s("code",[a._v("1024")]),a._v(" 的端口。")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" setcap cap_net_bind_service"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("+ep /usr/local/bin/caddy\n")])])]),s("p",[a._v("创建存储 "),s("code",[a._v("Caddy")]),a._v(" 配置文件 "),s("code",[a._v("Caddyfile")]),a._v(" 和 "),s("code",[a._v("SSL")]),a._v(" 证书的目录")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" /etc/caddy\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" -R root:www-data /etc/caddy\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" /etc/ssl/caddy\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" -R www-data:root /etc/ssl/caddy\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" 0770 /etc/ssl/caddy\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("touch")]),a._v(" /etc/caddy/Caddyfile\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" /var/www\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" www-data: /var/www\n")])])]),s("h2",{attrs:{id:"systemd-configuration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#systemd-configuration","aria-hidden":"true"}},[a._v("#")]),a._v(" SystemD Configuration")]),a._v(" "),s("p",[a._v("创建一个新的 "),s("code",[a._v("SystemD")]),a._v(" 配置脚本")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /lib/systemd/system/caddy.service\n")])])]),s("p",[a._v("caddy.service")]),a._v(" "),s("div",{staticClass:"language-config extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[Unit]\nDescription=Caddy HTTP/2 web server\nDocumentation=https://caddyserver.com/docs\nAfter=network-online.target\nWants=network-online.target\n\n[Service]\nRestart=on-failure\nStartLimitInterval=86400\nStartLimitBurst=5\n\nUser=www-data\nGroup=www-data\n; Letsencrypt-issued certificates will be written to this directory.\nEnvironment=CADDYPATH=/etc/ssl/caddy\n\nExecStart=/usr/local/bin/caddy -log stdout -agree=true -conf=/etc/caddy/Caddyfile -root=/var/tmp\nExecReload=/bin/kill -USR1 $MAINPID\n\nLimitNOFILE=1048576\nLimitNPROC=64\n\nPrivateTmp=true\nPrivateDevices=true\nProtectHome=true\nProtectSystem=full\nReadWriteDirectories=/etc/ssl/caddy\n\n; The following additional security directives only work with systemd v229 or later.\n; They further retrict privileges that can be gained by caddy. Uncomment if you like.\n; Note that you may have to add capabilities required by any plugins in use.\n;CapabilityBoundingSet=CAP_NET_BIND_SERVICE\n;AmbientCapabilities=CAP_NET_BIND_SERVICE\n;NoNewPrivileges=true\n[Install]\nWantedBy=multi-user.target\n")])])]),s("p",[a._v("启用 "),s("code",[a._v("Caddy")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("enable")]),a._v(" caddy.service\n")])])]),s("h2",{attrs:{id:"部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#部署","aria-hidden":"true"}},[a._v("#")]),a._v(" 部署")]),a._v(" "),s("ol",[s("li",[a._v("新建 "),s("code",[a._v("HTML")]),a._v(" 文件"),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" -p /var/www/blog\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Caddy"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /var/www/blog/index.html\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chown")]),a._v(" -R www-data: /var/www/blog\n")])])])]),a._v(" "),s("li",[a._v("编辑 "),s("code",[a._v("Caddyfile")]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/caddy/Caddyfile\n")])])]),a._v("🌰 :"),s("div",{staticClass:"language-config extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("www.domain.com {\n    root /var/www/blog\n}\n")])])])]),a._v(" "),s("li",[a._v("启动 "),s("code",[a._v("Caddy")]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl start caddy.service\n")])])])])])])},[],!1,null,null,null);t.default=n.exports}}]);