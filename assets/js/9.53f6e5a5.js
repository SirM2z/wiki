(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{201:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx","aria-hidden":"true"}},[t._v("#")]),t._v(" Nginx")]),t._v(" "),a("h2",{attrs:{id:"常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用命令","aria-hidden":"true"}},[t._v("#")]),t._v(" 常用命令")]),t._v(" "),a("h3",{attrs:{id:"ubuntu-平台"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu-平台","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("code",[t._v("Ubuntu")]),t._v(" 平台")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 检查配置")]),t._v("\nnginx -t\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 停止")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl stop nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启动")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重启")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl restart nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 仅修改配置，重新加载")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl reload nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 服务器引导时自动启动（默认）")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("enable")]),t._v(" nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 关闭 开机启动")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl disable nginx\n")])])]),a("h2",{attrs:{id:"常用文件目录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用文件目录","aria-hidden":"true"}},[t._v("#")]),t._v(" 常用文件目录")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("/var/www/html")]),t._v(" 默认 "),a("code",[t._v("Web")]),t._v(" 内容目录")]),t._v(" "),a("li",[a("code",[t._v("/etc/nginx")]),t._v(" 所有 Nginx 配置文件")]),t._v(" "),a("li",[a("code",[t._v("/etc/nginx/nginx.conf")]),t._v(" 主 "),a("code",[t._v("Nginx")]),t._v(" 配置文件，修改以更改 "),a("code",[t._v("Nginx")]),t._v(" 全局配置")]),t._v(" "),a("li",[a("code",[t._v("/var/log/nginx/access.log")]),t._v(" 所有请求日志文件")]),t._v(" "),a("li",[a("code",[t._v("/var/log/nginx/error.log")]),t._v(" 所有错误日志")])]),t._v(" "),a("h2",{attrs:{id:"常用配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用配置","aria-hidden":"true"}},[t._v("#")]),t._v(" 常用配置")]),t._v(" "),a("h3",{attrs:{id:"静态内容服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#静态内容服务","aria-hidden":"true"}},[t._v("#")]),t._v(" 静态内容服务")]),t._v(" "),a("div",{staticClass:"language-conf extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("server {\n  listen 80;\n  server_name www.domain1.com;\n  access_log logs/domain1.access.log main;\n  location / {\n    index index.html;\n    root /var/www/domain1.com;\n    try_files $uri $uri/ /index.html; # 单页应用\n  }\n}\n")])])]),a("h3",{attrs:{id:"代理端口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代理端口","aria-hidden":"true"}},[t._v("#")]),t._v(" 代理端口")]),t._v(" "),a("div",{staticClass:"language-conf extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("server {\n  listen 80;\n  server_name www.domain1.com;\n  location / {\n    proxy_pass http://localhost:5000;\n    proxy_redirect default;\n  }\n}\n")])])]),a("h2",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装","aria-hidden":"true"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-16-04",target:"_blank",rel:"noopener noreferrer"}},[t._v("安装教程"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("若启动不起来，参考如下问题（云服务器提供商做了手脚）\n"),a("a",{attrs:{href:"https://stackoverflow.com/questions/35868976/nginx-not-started-and-cant-start/40076325",target:"_blank",rel:"noopener noreferrer"}},[t._v("stackoverflow"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fuser")]),t._v(" -k 80/tcp\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fuser")]),t._v(" -k 443/tcp\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" nginx restart\n")])])]),a("h2",{attrs:{id:"https"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#https","aria-hidden":"true"}},[t._v("#")]),t._v(" HTTPS")]),t._v(" "),a("h3",{attrs:{id:"let-s-encrypt-证书申请"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#let-s-encrypt-证书申请","aria-hidden":"true"}},[t._v("#")]),t._v(" Let's Encrypt 证书申请")]),t._v(" "),a("p",[t._v("Let's Encrypt 提供了方便的命令行工具 "),a("a",{attrs:{href:"https://certbot.eff.org/lets-encrypt/ubuntuxenial-nginx",target:"_blank",rel:"noopener noreferrer"}},[t._v("certbot"),a("OutboundLink")],1),t._v("，"),a("code",[t._v("Ubuntu 16.04")]),t._v(" 执行命令:")]),t._v(" "),a("ol",[a("li",[t._v("将 "),a("code",[t._v("Certbot PPA")]),t._v(" 添加到存储库列表")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" software-properties-common\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" add-apt-repository universe\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" add-apt-repository ppa:certbot/certbot\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("安装 "),a("code",[t._v("Certbot")])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" certbot python-certbot-nginx\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[a("p",[a("code",[t._v("Nginx")]),t._v(" 配置好 80 端口网站以及域名 "),a("code",[t._v("server_name")]),t._v("，"),a("code",[t._v("Certbot")]),t._v(" 可以匹配 "),a("code",[t._v("Nginx")]),t._v(" 配置中的 "),a("code",[t._v("server_name")]),t._v("，并自动配置 "),a("code",[t._v("SSL")])])]),t._v(" "),a("li",[a("p",[t._v("通过防火墙允许 "),a("code",[t._v("HTTPS")])])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ufw "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("enable")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ufw allow "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Nginx Full'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" ufw delete allow "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Nginx HTTP'")]),t._v("\n")])])]),a("ol",{attrs:{start:"5"}},[a("li",[t._v("获取 "),a("code",[t._v("SSL")]),t._v(" 证书")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" certbot --nginx -d example.com -d www.example.com\n")])])]),a("ol",{attrs:{start:"6"}},[a("li",[t._v("验证 "),a("code",[t._v("Certbot")]),t._v(" 自动续订")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" certbot renew --dry-run\n")])])]),a("div",{staticClass:"tip custom-block"},[a("p",[t._v("参考"),a("a",{attrs:{href:"https://www.digitalocean.com/community/tutorials/how-to-secure-nginx-with-let-s-encrypt-on-ubuntu-16-04",target:"_blank",rel:"noopener noreferrer"}},[t._v("How To Secure Nginx with Let's Encrypt on Ubuntu 16.04"),a("OutboundLink")],1)])])])},[],!1,null,null,null);s.default=e.exports}}]);