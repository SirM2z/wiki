<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS | Ryan&#39;s wiki</title>
    <meta name="description" content="Just playing around">
    
    
    <link rel="preload" href="/wiki/assets/css/0.styles.f1c4b16e.css" as="style"><link rel="preload" href="/wiki/assets/js/app.4752983d.js" as="script"><link rel="preload" href="/wiki/assets/js/2.61203618.js" as="script"><link rel="preload" href="/wiki/assets/js/15.9d744a07.js" as="script"><link rel="prefetch" href="/wiki/assets/js/10.369c8747.js"><link rel="prefetch" href="/wiki/assets/js/11.c2f08b1a.js"><link rel="prefetch" href="/wiki/assets/js/12.a4d45bc5.js"><link rel="prefetch" href="/wiki/assets/js/13.be85fbad.js"><link rel="prefetch" href="/wiki/assets/js/14.c6c5554d.js"><link rel="prefetch" href="/wiki/assets/js/16.29c6d716.js"><link rel="prefetch" href="/wiki/assets/js/17.2deddcaf.js"><link rel="prefetch" href="/wiki/assets/js/18.1194b43a.js"><link rel="prefetch" href="/wiki/assets/js/3.6c57550a.js"><link rel="prefetch" href="/wiki/assets/js/4.471a4557.js"><link rel="prefetch" href="/wiki/assets/js/5.08534ce4.js"><link rel="prefetch" href="/wiki/assets/js/6.93296c5a.js"><link rel="prefetch" href="/wiki/assets/js/7.c0fe171b.js"><link rel="prefetch" href="/wiki/assets/js/8.f941e48d.js"><link rel="prefetch" href="/wiki/assets/js/9.835ff083.js">
    <link rel="stylesheet" href="/wiki/assets/css/0.styles.f1c4b16e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wiki/" class="home-link router-link-active"><!----> <span class="site-name">Ryan's wiki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/wiki/frontend/html.html" class="nav-link">前端</a></div><div class="nav-item"><a href="/wiki/backend/nestjs.html" class="nav-link">服务端</a></div><div class="nav-item"><a href="/wiki/db/postgresql.html" class="nav-link">数据库</a></div><div class="nav-item"><a href="/wiki/library/html2canvas.html" class="nav-link">工具库</a></div><div class="nav-item"><a href="/wiki/command/linux.html" class="nav-link">命令</a></div><div class="nav-item"><a href="https://www.ryanc.top/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Ryan's BLOG
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/SirM2z/wiki" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/wiki/frontend/html.html" class="nav-link">前端</a></div><div class="nav-item"><a href="/wiki/backend/nestjs.html" class="nav-link">服务端</a></div><div class="nav-item"><a href="/wiki/db/postgresql.html" class="nav-link">数据库</a></div><div class="nav-item"><a href="/wiki/library/html2canvas.html" class="nav-link">工具库</a></div><div class="nav-item"><a href="/wiki/command/linux.html" class="nav-link">命令</a></div><div class="nav-item"><a href="https://www.ryanc.top/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Ryan's BLOG
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/SirM2z/wiki" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>前端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wiki/frontend/html.html" class="sidebar-link">HTML</a></li><li><a href="/wiki/frontend/css.html" class="sidebar-link">CSS</a></li><li><a href="/wiki/frontend/js.html" class="active sidebar-link">JS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#模块化" class="sidebar-link">模块化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#commonjs" class="sidebar-link">CommonJS</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#amd" class="sidebar-link">AMD</a></li></ul></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#创建对象" class="sidebar-link">创建对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#原型对象" class="sidebar-link">原型对象</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#组合模式" class="sidebar-link">组合模式</a></li></ul></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#继承" class="sidebar-link">继承</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#原型链" class="sidebar-link">原型链</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#借用构造函数" class="sidebar-link">借用构造函数</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#组合继承" class="sidebar-link">组合继承</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#原型式继承" class="sidebar-link">原型式继承</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#寄生式继承" class="sidebar-link">寄生式继承</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#寄生式组合继承" class="sidebar-link">寄生式组合继承</a></li></ul></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#防抖" class="sidebar-link">防抖</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#节流" class="sidebar-link">节流</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#ajax-实现" class="sidebar-link">ajax 实现</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#array" class="sidebar-link">Array</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#map" class="sidebar-link">map</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#filter" class="sidebar-link">filter</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#foreach" class="sidebar-link">forEach</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#some" class="sidebar-link">some</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#every" class="sidebar-link">every</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#reduce" class="sidebar-link">reduce</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#reduceright" class="sidebar-link">reduceRight</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#splice" class="sidebar-link">splice</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#indexof" class="sidebar-link">indexOf</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#slice" class="sidebar-link">slice</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#concat" class="sidebar-link">concat</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#sort" class="sidebar-link">sort</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#reverse" class="sidebar-link">reverse()</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#join-symbol" class="sidebar-link">join(symbol)</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#shift-unshift-push-pop" class="sidebar-link">shift unshift push pop</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#array-from" class="sidebar-link">Array.from</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#array-of" class="sidebar-link">Array.of</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#copywithin" class="sidebar-link">copyWithin</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#find" class="sidebar-link">find</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#findindex" class="sidebar-link">findIndex</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#fill" class="sidebar-link">fill</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#entries" class="sidebar-link">entries()</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#keys" class="sidebar-link">keys()</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#values" class="sidebar-link">values()</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#includes" class="sidebar-link">includes</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#flat" class="sidebar-link">flat()</a></li><li class="sidebar-sub-header"><a href="/wiki/frontend/js.html#flatmap-function" class="sidebar-link">flatMap(function)</a></li></ul></li></ul></li><li><a href="/wiki/frontend/react.html" class="sidebar-link">React</a></li><li><a href="/wiki/frontend/crossDomain.html" class="sidebar-link">跨域</a></li><li><a href="/wiki/frontend/browser.html" class="sidebar-link">浏览器</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="js"><a href="#js" aria-hidden="true" class="header-anchor">#</a> JS</h1> <h2 id="模块化"><a href="#模块化" aria-hidden="true" class="header-anchor">#</a> 模块化</h2> <h3 id="commonjs"><a href="#commonjs" aria-hidden="true" class="header-anchor">#</a> CommonJS</h3> <p>NodeJS 所采用的模块化方案，简易实现：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token string">&quot;test conmmonjs require&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// index.js</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">requireSelf</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">moduleName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>moduleName<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> fn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token string">'module'</span><span class="token punctuation">,</span> <span class="token string">'exports'</span><span class="token punctuation">,</span> <span class="token string">'require'</span><span class="token punctuation">,</span> <span class="token string">'__dirname'</span><span class="token punctuation">,</span> <span class="token string">'__filename'</span><span class="token punctuation">,</span> content <span class="token operator">+</span> <span class="token string">'\n return module.exports'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// fn 相当于如下函数</span>
  <span class="token comment">// function(module, exports, require, __dirname, __filename) {</span>
  <span class="token comment">//   content + 'return module.exports'</span>
  <span class="token comment">// }</span>
  <span class="token keyword">let</span> module <span class="token operator">=</span> <span class="token punctuation">{</span>
    exports<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// const __dirname = __dirname;</span>
  <span class="token comment">// const __filename = __filename;</span>
  <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">(</span>module<span class="token punctuation">,</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">,</span> requireSelf<span class="token punctuation">,</span> __dirname<span class="token punctuation">,</span> __filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> str <span class="token operator">=</span> <span class="token function">requireSelf</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="amd"><a href="#amd" aria-hidden="true" class="header-anchor">#</a> AMD</h3> <p>适合浏览器端的异步加载方案，如 <code>require.js</code>，简单实现：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> factories <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">define</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">moduleName<span class="token punctuation">,</span> dependencies<span class="token punctuation">,</span> func</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 将依赖挂载在函数上</span>
  func<span class="token punctuation">.</span>dependencies <span class="token operator">=</span> dependencies<span class="token punctuation">;</span>
  factories<span class="token punctuation">[</span>moduleName<span class="token punctuation">]</span> <span class="token operator">=</span> func<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">_require</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">mods<span class="token punctuation">,</span> func</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> mods<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">moduleName</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> factory <span class="token operator">=</span> factories<span class="token punctuation">[</span>moduleName<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> _exports<span class="token punctuation">;</span>
    <span class="token keyword">let</span> dependencies <span class="token operator">=</span> factory<span class="token punctuation">.</span>dependencies<span class="token punctuation">;</span> <span class="token comment">// ['module1']</span>
    <span class="token function">_require</span><span class="token punctuation">(</span>dependencies<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> _exports<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'module1'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">'module1'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'module2'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'module1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">module1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> module1 <span class="token operator">+</span> <span class="token string">' module2'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">_require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'module2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">module2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>module2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// module1 module2</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="创建对象"><a href="#创建对象" aria-hidden="true" class="header-anchor">#</a> 创建对象</h2> <h3 id="原型对象"><a href="#原型对象" aria-hidden="true" class="header-anchor">#</a> 原型对象</h3> <div class="tip custom-block"><p>无论什么时候，只要创建了一个新函数，就会根据一组特定的规则为该函数创建一个 <code>prototype</code> 属性，这个属性指向函数的原型对象。在默认情况下，所有原型对象都会自动获得一个 <code>constructor</code>（构造函数）属性，这个属性是一个指向 <code>prototype</code> 属性所在函数的指针。</p> <p>《JavaScript 高级程序设计（第3版）》 p148（理解原型对象）</p></div> <h3 id="组合模式"><a href="#组合模式" aria-hidden="true" class="header-anchor">#</a> 组合模式</h3> <p>结合构造函数模式和原型模式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span> <span class="token comment">// 实例属性</span>
<span class="token punctuation">}</span>
<span class="token comment">// 共享方法</span>
<span class="token class-name">Foo</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="继承"><a href="#继承" aria-hidden="true" class="header-anchor">#</a> 继承</h2> <h3 id="原型链"><a href="#原型链" aria-hidden="true" class="header-anchor">#</a> 原型链</h3> <p>每个函数对象都含有一个原型对象，当访问某个对象的属性时，会先从自身属性查找（函数对象则从自身的原型对象中查找），若没有查到，就会从原型对象中查找，这个查找过程就是原型链的体现</p> <div class="tip custom-block"><p>构造函数、原型和实例的关系：每个构造函数都有一个原型对象，原型对象都包含一个指向构造函数的指针，而实例都包含一个指向原型对象的内部指针。</p> <p>《JavaScript 高级程序设计（第3版）》 p162（原型链）</p></div> <p>原型链继承</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 实例属性</span>
<span class="token punctuation">}</span>
<span class="token comment">// 共享方法</span>
<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getSuperValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>subValue <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// 实例属性</span>
<span class="token punctuation">}</span>
<span class="token comment">// 继承 SuperType</span>
<span class="token comment">// 重写 prototype 导致 constructor 等于 SuperType.prototype.constructor</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 共享方法</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getSubValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>subValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// sub 的 constructor 由于原型链的缘故指向 SuperType 而非 SubType</span>
<span class="token keyword">var</span> sub <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sub<span class="token punctuation">.</span><span class="token function">getSuperValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
sub<span class="token punctuation">.</span><span class="token function">getSubValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre></div><p>存在的问题：</p> <ol><li>父类中<strong>引用类型的实例属性</strong>变成子类的<strong>原型属性</strong>，即实例的共享属性<div class="language-JS extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 实例属性</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sub1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sub2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sub1<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sub2<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ==&gt; [1, 2]</span>
</code></pre></div></li> <li>创建子类型的实例时，不能很好的向父类型的构造函数中传递参数</li></ol> <h3 id="借用构造函数"><a href="#借用构造函数" aria-hidden="true" class="header-anchor">#</a> 借用构造函数</h3> <p>此方式可以解决上述两个问题</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这里调用父类构造函数，转换实例属性</span>
  <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 继承 SuperType</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sub1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sub2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sub1<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sub1<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ==&gt; [1, 2]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sub2<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ==&gt; [1]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sub1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ==&gt; &quot;name&quot;</span>
</code></pre></div><p>单纯使用<strong>借用构造函数</strong>方式，所有方法就必须在构造函数中声明，函数复用就无从谈起</p> <h3 id="组合继承"><a href="#组合继承" aria-hidden="true" class="header-anchor">#</a> 组合继承</h3> <p>原型链加借用构造函数的方式称为<strong>组合继承</strong>，原理：</p> <ul><li>使用原型链实现对原型属性和方法的继承</li> <li>通过借用构造函数来实现对实例属性的继承</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这里调用父类构造函数，转换实例属性</span>
  <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>subValue <span class="token operator">=</span> <span class="token string">'subValue'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 继承 SuperType</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> SubType<span class="token punctuation">;</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>subValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> sub1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">'sub1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sub1<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sub1<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2]</span>
sub1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;sub1&quot;</span>
sub1<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;subValue&quot;</span>

<span class="token keyword">var</span> sub2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">'sub2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sub2<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1]</span>
sub2<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;sub2&quot;</span>
sub2<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;subValue&quot;</span>
</code></pre></div><p>依然有个问题，这种继承实现必须调用两次父类的构造函数：</p> <ol><li>在创建子类型原型的时候：<code>SubType.prototype = new SuperType();</code>，这里把 <code>SuperType</code> 的实例赋值给 <code>SubType</code> 的原型，因此 <code>SubType</code> 的原型上实例化了 <code>value, name</code> 属性</li> <li>在子类型的构造函数内部：<code>SuperType.call(this, name);</code>，这里通过 <code>call</code> 函数将 <code>value, name</code> 属性定义在 <code>this</code> 上</li></ol> <p>因此可以看出，<code>SubType</code> 的实例属性和原型对象属性中存在两份相同的属性，即 <code>value, name</code></p> <h3 id="原型式继承"><a href="#原型式继承" aria-hidden="true" class="header-anchor">#</a> 原型式继承</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">object</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  friends<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> personA <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
personA<span class="token punctuation">.</span>friends<span class="token punctuation">,</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> personB <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
personA<span class="token punctuation">.</span>friends<span class="token punctuation">,</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>friends<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ['a', 'b', 'c', 'd']</span>
</code></pre></div><p>只想让一个对象与另一个对象保持类似的情况下，<strong>原型式继承</strong>是完全可以胜任的。不过包含引用类型值的属性都会共享相应的值，就像使用原型模式一样</p> <p><code>ES5</code> 中 <code>Object.create</code> 方法传入一个参数时，与 <code>object</code> 方法的行为相同</p> <h3 id="寄生式继承"><a href="#寄生式继承" aria-hidden="true" class="header-anchor">#</a> 寄生式继承</h3> <p>这种思路与寄生式构造函数和工厂模式类似，即创建一个仅用于封装继承过程的函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createAnother</span><span class="token punctuation">(</span><span class="token parameter">original</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> clone <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 通过调用函数创建一个新对象</span>
  clone<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> clone<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  friends<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> personA <span class="token operator">=</span> <span class="token function">createAnother</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
personA<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'hi'</span>
</code></pre></div><h3 id="寄生式组合继承"><a href="#寄生式组合继承" aria-hidden="true" class="header-anchor">#</a> 寄生式组合继承</h3> <p>前面说过<strong>组合继承</strong>的一些问题，这里可以通过引入 <strong>寄生式继承</strong> 避免 <strong>在创建子类型原型的时候</strong> 调用父类的构造函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">inheritPrototype</span><span class="token punctuation">(</span><span class="token parameter">subType<span class="token punctuation">,</span> superType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>superType<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
  prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> subType<span class="token punctuation">;</span>
  subType<span class="token punctuation">.</span>prototype <span class="token operator">=</span> prototype<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>寄生式组合继承实现：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 这里调用父类构造函数，转换实例属性</span>
  <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>subValue <span class="token operator">=</span> <span class="token string">'subValue'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 继承 SuperType</span>
<span class="token function">inheritPrototype</span><span class="token punctuation">(</span>SubType<span class="token punctuation">,</span> SuperType<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>subValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这种实现方式只调用了一次 <code>SuperType</code>构造函数，因此避免了在 <code>SubType.prototype</code> 上面创建不必要的、多余的属性，并且保持原型链不变</p> <p><strong>寄生式组合继承</strong>被普遍认为是引用类型最理想的继承范式</p> <h2 id="防抖"><a href="#防抖" aria-hidden="true" class="header-anchor">#</a> 防抖</h2> <p>方法在 n 毫秒后调用，期间有再次调用将重置时间，重新等待 n 毫秒。常用 输入框 远程搜索</p> <h2 id="节流"><a href="#节流" aria-hidden="true" class="header-anchor">#</a> 节流</h2> <p>每隔 n 毫秒调用一次方法，期间所有调用无效。常用 滚动事件 或 窗口 size 变化</p> <h2 id="ajax-实现"><a href="#ajax-实现" aria-hidden="true" class="header-anchor">#</a> ajax 实现</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> isAsync <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 默认 true</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// document.cookie = 'abc';</span>
<span class="token comment">// xhr.withCredentials = true; // 跨域携带 cookie</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'url'</span><span class="token punctuation">,</span> isAsync<span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 0 尚未调用 open</span>
  <span class="token comment">// 1 调用 open 但还未 send</span>
  <span class="token comment">// 2 已执行 send</span>
  <span class="token comment">// 3 接收到数据</span>
  <span class="token comment">// 4 请求完成</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">&gt;=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">300</span> <span class="token operator">||</span> xhr<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">304</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="array"><a href="#array" aria-hidden="true" class="header-anchor">#</a> Array</h2> <h3 id="map"><a href="#map" aria-hidden="true" class="header-anchor">#</a> map</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">map</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index<span class="token punctuation">,</span> array</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// ES5</span>
</code></pre></div><ul><li>对数组每一项运行给定的函数，返回每次调用函数的结果组成的数组</li> <li>不会改变原数组，返回值是一个新数组</li> <li>如果数组元素是对象，那么是浅拷贝过去，修改对象属性会影响到原数组对象的属性</li></ul> <h3 id="filter"><a href="#filter" aria-hidden="true" class="header-anchor">#</a> filter</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index<span class="token punctuation">,</span> array</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// ES5</span>
</code></pre></div><ul><li>对数组进行过滤，对数组每一项运行给定的函数，返回该函数返回true的项组成的数组</li> <li>返回是一个新数组，不会影响到原数组</li> <li>同样，对于对象元素，是浅拷贝</li></ul> <h3 id="foreach"><a href="#foreach" aria-hidden="true" class="header-anchor">#</a> forEach</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">forEach</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index<span class="token punctuation">,</span> array</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>遍历函数，不会修改原数组，该方法没有返回值</li> <li>无法使用break终止循环，意味着forEach是无法终止循环的</li> <li>for循环可使用continue跳过本次循环，forEach中可以return false 来跳过本次循环</li></ul> <h3 id="some"><a href="#some" aria-hidden="true" class="header-anchor">#</a> some</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index<span class="token punctuation">,</span> array</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>用于查询数组中的项是否满足某个条件</li> <li>只要有一项返回true，则调用结束，返回true。全部返回false，则调用结果为false</li> <li>不会改变原数组</li></ul> <h3 id="every"><a href="#every" aria-hidden="true" class="header-anchor">#</a> every</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">every</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index<span class="token punctuation">,</span> array</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>用于查询数组中的项是否满足某个条件</li> <li>只要有一项返回false，则调用结束，返回false。全部返回true，则调用结果为true</li> <li>不会改变原数组</li></ul> <h3 id="reduce"><a href="#reduce" aria-hidden="true" class="header-anchor">#</a> reduce</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">prev<span class="token punctuation">,</span> cur<span class="token punctuation">,</span> index<span class="token punctuation">,</span> array</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> init<span class="token punctuation">)</span>
</code></pre></div><ul><li>数组的归并方法</li> <li>第二个参数可选，作为归并的起始值，默认是数组第一个元素</li> <li>第一次归并是，prev是数组第一个元素，cur为第二个元素，返回值为下次归并的prev。以此类推</li> <li>返回值是最后一次归并的回调函数返回值</li> <li>不会改变原数组</li></ul> <h3 id="reduceright"><a href="#reduceright" aria-hidden="true" class="header-anchor">#</a> reduceRight</h3> <ul><li>同reduce，reduce是从左边开始归并，reduceRight是从右边开始归并</li></ul> <h3 id="splice"><a href="#splice" aria-hidden="true" class="header-anchor">#</a> splice</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">splice</span><span class="token punctuation">(</span>deleteIndex<span class="token punctuation">,</span> deleteNum<span class="token punctuation">,</span> addValue1<span class="token punctuation">,</span> addValue2<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>该方法算是最强大的数组方法了，在指定位置开始(deleteIndex，包括该位置)，删除相应个数(deleteNum)，并在该位置插入相应值(从第三个参数开始，依次插入)</li> <li>该方法可以实现对数组的删除、插入、替换</li> <li>返回值为一个数组，包含从原数组删除的想，没有删除则返回空数组</li> <li>该方法会修改原数组</li></ul> <h3 id="indexof"><a href="#indexof" aria-hidden="true" class="header-anchor">#</a> indexOf</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">indexOf</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> start<span class="token punctuation">)</span>
</code></pre></div><ul><li>查找某个元素的索引</li> <li>内部使用全等符号，必须严格相等</li> <li>第二个参数指定查找起点</li> <li>lastIndexOf()从右到左，indexOf从左到右</li> <li>可以使用ES6中includes、find、findIndex代替</li></ul> <h3 id="slice"><a href="#slice" aria-hidden="true" class="header-anchor">#</a> slice</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">slice</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span>
</code></pre></div><ul><li>返回新数组，不会改变原数组</li> <li>截取原数组一段返回，从start（包括）位置，到end（不包括）结束位置</li></ul> <h3 id="concat"><a href="#concat" aria-hidden="true" class="header-anchor">#</a> concat</h3> <ul><li>合并数组，返回新数组，不会改变原数组</li> <li>没有传参，返回当前调用该方法的数组(浅拷贝)</li> <li>如果参数不是数组，依次加入到数组末尾，如果是数组，将数组拆开(只能拆开一层)依次加入到末尾</li></ul> <h3 id="sort"><a href="#sort" aria-hidden="true" class="header-anchor">#</a> sort</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>数组各项比较时会先调用数组项的toString()方法，所以比较时字符串的比较</li></ul> <h3 id="reverse"><a href="#reverse" aria-hidden="true" class="header-anchor">#</a> reverse()</h3> <ul><li>对数组进行倒序，该方法是在原数组上进行的，会修改原数组</li> <li>返回值是原数组</li></ul> <h3 id="join-symbol"><a href="#join-symbol" aria-hidden="true" class="header-anchor">#</a> join(symbol)</h3> <ul><li>以给定的符合将数组连接起来，返回值为字符串</li> <li>如何元素中有数组，会把元素数组合并放入该位置</li></ul> <h3 id="shift-unshift-push-pop"><a href="#shift-unshift-push-pop" aria-hidden="true" class="header-anchor">#</a> shift unshift push pop</h3> <table><thead><tr><th>方法</th> <th>功能</th> <th>返回</th></tr></thead> <tbody><tr><td>shift</td> <td>移除第一个元素</td> <td>第一个元素</td></tr> <tr><td>unshift</td> <td>在首部加入一个元素</td> <td>新数组长度</td></tr> <tr><td>push</td> <td>在末尾加入一个元素</td> <td>新数组长度</td></tr> <tr><td>pop</td> <td>移除最后一个元素</td> <td>最后一个元素</td></tr></tbody></table> <div class="tip custom-block"><p>以上四个方法均会改变原数组</p></div> <h3 id="array-from"><a href="#array-from" aria-hidden="true" class="header-anchor">#</a> Array.from</h3> <div class="language-js extra-class"><pre class="language-js"><code>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>targeObj<span class="token punctuation">,</span> mapFunction<span class="token punctuation">,</span> mapThis<span class="token punctuation">)</span>
</code></pre></div><ul><li>生成数组的方法，返回值为一个新数组</li> <li>从类数组对象、数组、实现了iterator接口的对象生成一个数组</li> <li>是对原对象的拷贝，且是浅拷贝，意味着修改新的数组元素会影响到原对象</li> <li>如果数组元素为非对象类型，修改新数组不会影响到原对象</li> <li>可以接受第二个参数，一个函数，相当于map函数，对每个元素进行相应处理再放入新数组中</li> <li>第三个参数，指定第二个参数函数内this</li></ul> <h3 id="array-of"><a href="#array-of" aria-hidden="true" class="header-anchor">#</a> Array.of</h3> <div class="language-js extra-class"><pre class="language-js"><code>Array<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>val1<span class="token punctuation">,</span> val2<span class="token punctuation">,</span> val3<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>生成数组的方法，返回一个新的数组</li> <li>通过将一组数据生成数组</li> <li>解决Array()由于参数不同产生不同行为的问题</li> <li>当参数为空时，返回一个空数组</li></ul> <h3 id="copywithin"><a href="#copywithin" aria-hidden="true" class="header-anchor">#</a> copyWithin</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">copyWithin</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>
</code></pre></div><ul><li>在当前数组内部，将指定位置的成员复制到其他位置（会覆盖原有成员），然后返回当前数组</li> <li>该方法会修改当前数组</li> <li>结束参数不包括end位置</li> <li>数组长度不变，数组start到end-1的元素会从target(包括该位置)开始依次覆盖数组原有成员</li> <li>参数可以是负数，表示倒数</li></ul> <h3 id="find"><a href="#find" aria-hidden="true" class="header-anchor">#</a> find</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> index <span class="token punctuation">,</span>arr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>找出第一个符合条件的数组成员，当回调函数中返回true，则符合条件；如果都没有，则返回undefined</li> <li>接受第二个参数，用来绑定回调函数的this对象</li></ul> <h3 id="findindex"><a href="#findindex" aria-hidden="true" class="header-anchor">#</a> findIndex</h3> <ul><li>使用与find一致，该方法返回数组成员的位置</li></ul> <h3 id="fill"><a href="#fill" aria-hidden="true" class="header-anchor">#</a> fill</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">fill</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> start<span class="token punctuation">,</span> end<span class="token punctuation">)</span>
</code></pre></div><ul><li>将给定的值，填充数组</li> <li>第二个参数，指定填充的起始位置(包括该位置)</li> <li>第三个参数，指定填充的结束位置(不包括该位置)</li> <li>如果填充的对象是对象，那么赋值的是同一个内存地址的对象，也就是浅拷贝(嗯，浅拷贝，就知道会发生什么事)</li></ul> <h3 id="entries"><a href="#entries" aria-hidden="true" class="header-anchor">#</a> entries()</h3> <ul><li>用于遍历数组</li> <li>返回值为数组，里面的元素也是数组，第一元素是下标，第二个是元素值。[[0, 'a'], [1, 'b'], [3, 'c']]</li></ul> <h3 id="keys"><a href="#keys" aria-hidden="true" class="header-anchor">#</a> keys()</h3> <ul><li>用于遍历数组</li> <li>返回数组的键名组成的数组</li></ul> <h3 id="values"><a href="#values" aria-hidden="true" class="header-anchor">#</a> values()</h3> <ul><li>用于遍历数组</li> <li>返回数组键值组成的数组</li></ul> <h3 id="includes"><a href="#includes" aria-hidden="true" class="header-anchor">#</a> includes</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">includes</span><span class="token punctuation">(</span>start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>返回值一个布尔值，判断数组是否包含给定的值</li> <li>ES2016引入该方法，类似于字符串的includes方法</li> <li>第二个参数指定搜索的起始位置，如果是负数，表示倒数位置</li> <li>相对于indexOf，该方法更加语义化。另外NaN.includes(NaN)返回true，而indexOf不能判断。</li> <li>可以使用ES5中的some方法实现该功能</li></ul> <h3 id="flat"><a href="#flat" aria-hidden="true" class="header-anchor">#</a> flat()</h3> <ul><li>对数组内嵌套的数组“拉平”，就是把数组中的数组的元素挨个拿出来，放数组元素所在位置，返回一个新的数组，不会影响到原来的数组</li> <li>接收第二个参数，只能拉平的层数，默认只有一层。想无限拉平可以传入Infinity关键字</li></ul> <h3 id="flatmap-function"><a href="#flatmap-function" aria-hidden="true" class="header-anchor">#</a> flatMap(function)</h3> <ul><li>同flat一样，先执行map函数再进行拉平</li> <li>只能拉平一层</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">7/11/2019, 3:43:09 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/wiki/frontend/css.html" class="prev">
          CSS
        </a></span> <span class="next"><a href="/wiki/frontend/react.html">
          React
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/wiki/assets/js/app.4752983d.js" defer></script><script src="/wiki/assets/js/2.61203618.js" defer></script><script src="/wiki/assets/js/15.9d744a07.js" defer></script>
  </body>
</html>
